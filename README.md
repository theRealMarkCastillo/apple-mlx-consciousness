# ğŸ§  Apple MLX Consciousness Research

[![MLX](https://img.shields.io/badge/MLX-0.30.0-blue)](https://github.com/ml-explore/mlx)
[![Python](https://img.shields.io/badge/Python-3.13+-green)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

**Pushing the boundaries of cognitive simulation using Apple Silicon's unified memory architecture.**

This research project explores how **Apple Silicon (M-series chips)** enables breakthrough implementations of consciousness theories at scale. By leveraging **64GB unified memory** with zero-copy data sharing, we simulate multi-agent cognitive systems impossible on traditional GPU architectures.

---

## ğŸ¯ Project Vision

**Hypothesis:** Apple Silicon's unified memory architecture enables novel cognitive simulations that demonstrate emergent collective consciousness in multi-agent systems.

**Current Focus:** Building from single-agent demonstrations to 100+ agent swarms with shared episodic memory and collective decision-making.

**Target Impact:** Publishable research at the intersection of cognitive science, AI/ML, and systems architecture.

---

## ğŸ—ï¸ Architecture: "Bicameral Global Workspace"

The core `BicameralAgent` integrates multiple consciousness theories:

### 1. **Global Workspace Theory (Baars, 1988)**
- Shared "stream of consciousness" broadcasts information to all cognitive modules
- Implemented as a persistent state vector in unified memory
- **Apple Silicon Advantage:** Zero-copy access from CPU, GPU, and Neural Engine

### 2. **Dual-Process Theory (Kahneman, 2011)**
- **System 1:** Fast, automatic, intuitive processing (shallow neural network)
- **System 2:** Slow, deliberate, meta-cognitive monitoring (evaluates confidence)
- Detects uncertainty via entropy and triggers intervention (recall or imagination)

### 3. **Episodic Memory (Hippocampal Model)**
- Content-addressable storage: (State, Action, Reward, NextState) tuples
- GPU-accelerated cosine similarity retrieval (10M+ memories possible)
- **Apple Silicon Advantage:** All agents share one memory pool with instant access

### 4. **World Model (Prefrontal Cortex)**
- Predictive neural network: `f(state, action) â†’ next_state`
- Enables "imagination" - mental simulation before acting
- Trained during "sleep" cycles via batch consolidation

### 5. **Meta-Cognition & Top-Down Attention**
- System 2 sets goal vectors that bias perception
- Implements selective attention and confirmation bias
- Monitors self-confidence to trigger deliberate reasoning

---

## ğŸ“‚ Repository Structure

```
apple-mlx-consciousness/
â”œâ”€â”€ cognitive_architecture.py      # Core: BicameralAgent, GlobalWorkspace, Memory, WorldModel
â”œâ”€â”€ simulation.py                  # CLI demo: Stream of consciousness with recall/imagination
â”œâ”€â”€ conscious_chatbot.py           # Application: Chatbot with internal meta-cognition
â”‚
â”œâ”€â”€ 01_Global_Workspace_Demo.ipynb     # ğŸ“Š Educational: Theory + visualizations
â”œâ”€â”€ 02_Learning_and_Dreaming.ipynb     # ğŸŒ™ Experiment: Sleep consolidation benefits
â”œâ”€â”€ 03_Conscious_Chatbot_Internals.ipynb  # ğŸ’¬ Analysis: Real-time thought visualization
â”‚
â”œâ”€â”€ requirements.txt               # Python dependencies (pinned versions)
â”œâ”€â”€ README.md                      # This file
â”œâ”€â”€ ROADMAP.md                     # Research plan & milestones
â””â”€â”€ .gitignore                     # Version control settings
```

### Key Files

| File | Description |
|------|-------------|
| **`cognitive_architecture.py`** | Complete implementation of the Bicameral architecture with all cognitive modules |
| **`01_Global_Workspace_Demo.ipynb`** | â­ **START HERE** - Educational notebook with theory explanations and visualizations |
| **`ROADMAP.md`** | Research timeline: single-agent â†’ multi-agent swarm â†’ phase transitions |
| **`simulation.py`** | Terminal-based demo showing flow states, recall events, and dreaming cycles |

---

## ğŸš€ Quick Start

### Prerequisites

- **macOS** with Apple Silicon (M1/M2/M3/M4)
- **Python 3.13+**
- **64GB RAM recommended** (for multi-agent experiments)
  - **Tested on:** Mac Mini M4 Pro (Model: Mac16,11)
  - **CPU:** 14 cores (10 performance + 4 efficiency)
  - **GPU:** 20 cores with Metal 4
  - **Memory:** 64GB LPDDR5 unified

### Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/apple-mlx-consciousness.git
cd apple-mlx-consciousness

# Install dependencies
pip install -r requirements.txt
```

### Run Examples

**1. Interactive Notebooks (Recommended)**
```bash
# Open in VS Code or Jupyter
code 01_Global_Workspace_Demo.ipynb
```

**2. Terminal Simulation**
```bash
python simulation.py
```
*Watch for `ğŸ”´ RECALL` (memory retrieval) and `ğŸŸ¢ Flow` (automatic processing)*

**3. Conscious Chatbot**
```bash
python conscious_chatbot.py
```
*Chat with an agent that shows its internal confidence and thought process*

---

## ğŸ“Š Current Results (Phase 1: Single Agent)

### Key Metrics from `01_Global_Workspace_Demo.ipynb`

- **Simulation:** 50 cognitive cycles with random sensory input
- **Memory:** 89 episodic experiences stored during run
- **Dreaming:** World Model MSE improved to 0.4438 after sleep consolidation
- **Meta-Cognition:** Correlation between entropy and confidence: -0.0124 (needs improvement)
- **Cognitive Strategies:**
  - **Flow (blue):** Automatic processing - 17 instances
  - **Imagination (green):** World Model simulation - 33 instances  
  - **Recall (red):** Memory retrieval - sparse (early training phase)

### Visualizations Generated

1. **Global Workspace Heatmap** - "Stream of consciousness" evolving over time
2. **Entropy vs. Confidence** - Meta-cognitive monitoring dynamics
3. **Goal Vector Heatmap** - Top-down attention patterns
4. **Action Probability Stream** - Decision-making dynamics
5. **Cognitive Phase Space** - State-of-mind scatter plot (flow/recall/imagination zones)

---

## ğŸ”¬ Research Roadmap

See **[ROADMAP.md](ROADMAP.md)** for detailed timeline. Summary:

### âœ… Phase 1: Foundation (Completed)
- Single-agent architecture validated
- Educational materials with theory explanations
- Baseline performance metrics established

### ğŸ¯ Phase 2: Multi-Agent Swarm (Current - Weeks 1-6)
- Design shared consciousness architecture
- Implement 100-agent system leveraging unified memory
- Study emergent collective behavior (culture, communication, roles)

### ğŸŒ™ Phase 3: Consciousness Phase Transitions (Weeks 7-16)
- Parameter sweeps to identify consciousness "tipping points"
- Implement Integrated Information Theory (Î¦) metrics
- Publish findings: emergent consciousness at scale

### ğŸš€ Phase 4: Advanced Extensions (Future)
- Hierarchical Temporal Memory (HTM) integration
- Neural Engine optimization (hybrid CPU/GPU/ANE)
- Lifelong learning without catastrophic forgetting

---

## ğŸ’¡ Why Apple Silicon?

### Unified Memory Advantage

Traditional GPU systems suffer from:
- âŒ Limited VRAM (16-24GB typical)
- âŒ PCIe transfer bottleneck (CPU â†” GPU copying)
- âŒ Separate memory pools for multi-agent systems

**Apple Silicon M4 Pro (Mac Mini):**
- âœ… **14-core CPU** (10 performance + 4 efficiency cores)
- âœ… **20-core GPU** with Metal 4 support
- âœ… **16-core Neural Engine** for ML acceleration
- âœ… **64GB unified LPDDR5 memory** shared across all processors
- âœ… **Zero-copy architecture** - no data transfer overhead
- âœ… **273 GB/s bandwidth** - instant access to 10M+ memories
- âœ… **Energy efficient** - ~100W vs. 450W for NVIDIA 4090

### Concrete Benefits for Cognitive Simulation

| Feature | Traditional GPU | Apple M4 Pro (Mac Mini, 64GB) |
|---------|----------------|-------------------------------|
| **Agent capacity** | 10-20 agents | 100+ agents |
| **Shared memory** | Must duplicate data | Single shared pool |
| **Memory retrieval** | 1M memories max | 10M+ memories |
| **Transfer overhead** | 10-100ms per copy | Zero (unified) |
| **Multi-model execution** | Sequential | Parallel (CPU+GPU+ANE) |

---

## ğŸ“ Educational Resources

### Notebooks Include Theory Explanations

Each notebook contains:
- ğŸ“š **Theoretical background** - Original papers and key concepts
- ğŸ—ï¸ **Architectural decisions** - Why we implemented it this way
- ğŸ“Š **Result interpretation** - What the visualizations mean
- ğŸ”§ **Suggested experiments** - How to extend the research

### Key References

- **Baars, B. J. (1988).** *A Cognitive Theory of Consciousness.* Cambridge University Press.
- **Kahneman, D. (2011).** *Thinking, Fast and Slow.* Farrar, Straus and Giroux.
- **Tononi, G. (2004).** "An information integration theory of consciousness." *BMC Neuroscience*.
- **Dehaene, S. et al. (2017).** "What is consciousness, and could machines have it?" *Science*.

---

## ğŸ¤ Contributing

This is an active research project. Contributions welcome in:

- **Code:** Performance optimizations, new cognitive modules
- **Science:** Novel experiments, metric proposals, theory integration
- **Documentation:** Tutorial notebooks, architecture explanations
- **Benchmarking:** Comparisons with other frameworks/hardware

**To contribute:**
1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-idea`)
3. Commit changes with clear messages
4. Push and open a Pull Request

---

## ğŸ“œ License

MIT License - see [LICENSE](LICENSE) file for details.

---

## ğŸ™ Acknowledgments

- **Apple MLX Team** - For the incredible unified memory framework
- **Bernard Baars** - Global Workspace Theory foundation
- **Daniel Kahneman** - Dual-process theory insights
- **Jeff Hawkins** - HTM inspiration for future work

---

## ğŸ“¬ Contact & Updates

- **GitHub Issues:** [Report bugs or request features](https://github.com/yourusername/apple-mlx-consciousness/issues)
- **Discussions:** [Share ideas and results](https://github.com/yourusername/apple-mlx-consciousness/discussions)
- **Twitter/X:** [@yourusername](https://twitter.com/yourusername) - Follow for updates

---

## ğŸŒŸ Star History

If you find this research useful, please â­ star the repository to help others discover it!

---

**Built with â¤ï¸ on Apple Silicon | Exploring the computational basis of consciousness**
